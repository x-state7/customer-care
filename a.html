<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FleetCare Pro ‚Äì Contract Management System</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600;700&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #f0f2f5;
  --surface: #ffffff;
  --surface2: #f8f9fb;
  --border: #e2e6ed;
  --border-light: #edf0f4;
  --blue: #2563eb;
  --blue-light: #dbeafe;
  --blue-dark: #1d4ed8;
  --green: #16a34a;
  --green-light: #dcfce7;
  --red: #dc2626;
  --red-light: #fee2e2;
  --yellow: #d97706;
  --yellow-light: #fef3c7;
  --text: #111827;
  --text2: #6b7280;
  --text3: #9ca3af;
  --sidebar: #0f172a;
  --sidebar-text: #94a3b8;
  --sidebar-active: #2563eb;
  --radius: 8px;
  --shadow: 0 1px 3px rgba(0,0,0,0.08), 0 1px 2px rgba(0,0,0,0.04);
  --shadow-md: 0 4px 6px rgba(0,0,0,0.07), 0 2px 4px rgba(0,0,0,0.05);
  --shadow-lg: 0 10px 15px rgba(0,0,0,0.1), 0 4px 6px rgba(0,0,0,0.05);
}

* { margin:0; padding:0; box-sizing:border-box; }
body { font-family:'DM Sans',sans-serif; background:var(--bg); color:var(--text); display:flex; min-height:100vh; font-size:14px; }

/* SIDEBAR */
.sidebar {
  width:240px; min-height:100vh; background:var(--sidebar);
  display:flex; flex-direction:column; position:fixed; top:0; left:0; z-index:100;
}
.sidebar-logo {
  padding:20px 20px 16px;
  border-bottom:1px solid rgba(255,255,255,0.07);
}
.sidebar-logo .logo-mark {
  display:flex; align-items:center; gap:10px;
}
.logo-icon {
  width:34px; height:34px; background:var(--blue);
  border-radius:8px; display:flex; align-items:center; justify-content:center;
  font-size:16px;
}
.logo-text { color:#f8fafc; font-weight:700; font-size:15px; letter-spacing:-0.3px; }
.logo-sub { color:var(--sidebar-text); font-size:10px; margin-top:1px; }

/* Role Badge */
.role-section {
  padding:12px 16px;
  border-bottom:1px solid rgba(255,255,255,0.07);
}
.role-selector {
  background:rgba(255,255,255,0.06); border:1px solid rgba(255,255,255,0.1);
  border-radius:6px; padding:8px 10px; width:100%;
  color:#e2e8f0; font-family:'DM Sans',sans-serif; font-size:12px;
  cursor:pointer; outline:none;
}
.role-selector option { background:#0f172a; }
.role-label { color:var(--sidebar-text); font-size:10px; text-transform:uppercase; letter-spacing:0.8px; margin-bottom:6px; }

.sidebar-nav { flex:1; padding:8px 10px; overflow-y:auto; }
.nav-section-label {
  color:rgba(148,163,184,0.5); font-size:10px; text-transform:uppercase;
  letter-spacing:0.8px; padding:12px 8px 6px; font-weight:600;
}
.nav-item {
  display:flex; align-items:center; gap:10px; padding:9px 10px;
  border-radius:6px; cursor:pointer; color:var(--sidebar-text);
  font-size:13px; font-weight:500; transition:all 0.15s; margin-bottom:1px;
  position:relative;
}
.nav-item:hover { background:rgba(255,255,255,0.07); color:#e2e8f0; }
.nav-item.active { background:rgba(37,99,235,0.2); color:#60a5fa; }
.nav-item.active::before {
  content:''; position:absolute; left:-10px; top:50%; transform:translateY(-50%);
  width:3px; height:18px; background:var(--blue); border-radius:0 2px 2px 0;
}
.nav-item .icon { width:16px; text-align:center; font-size:14px; }
.nav-badge {
  margin-left:auto; background:var(--blue); color:#fff;
  font-size:10px; font-weight:700; padding:2px 6px; border-radius:10px;
}
.nav-item.locked { opacity:0.4; cursor:not-allowed; }
.nav-item.locked:hover { background:transparent; color:var(--sidebar-text); }

.sidebar-user {
  padding:14px 16px; border-top:1px solid rgba(255,255,255,0.07);
  display:flex; align-items:center; gap:10px;
}
.user-avatar {
  width:32px; height:32px; border-radius:50%;
  background:var(--blue); display:flex; align-items:center;
  justify-content:center; font-weight:700; font-size:13px; color:#fff; flex-shrink:0;
}
.user-name { color:#e2e8f0; font-size:12px; font-weight:600; }
.user-role-tag { color:var(--sidebar-text); font-size:10px; }

/* MAIN */
.main { margin-left:240px; flex:1; display:flex; flex-direction:column; min-height:100vh; }

/* TOPBAR */
.topbar {
  background:var(--surface); border-bottom:1px solid var(--border);
  padding:0 28px; height:58px; display:flex; align-items:center;
  justify-content:space-between; position:sticky; top:0; z-index:50;
}
.topbar-left { display:flex; align-items:center; gap:12px; }
.page-title { font-size:16px; font-weight:700; color:var(--text); letter-spacing:-0.3px; }
.breadcrumb { color:var(--text3); font-size:12px; }
.topbar-right { display:flex; align-items:center; gap:12px; }
.topbar-btn {
  display:flex; align-items:center; gap:6px; padding:7px 14px;
  border-radius:6px; font-size:12px; font-weight:600; cursor:pointer; transition:all 0.15s;
  border:none; font-family:'DM Sans',sans-serif;
}
.btn-primary { background:var(--blue); color:#fff; }
.btn-primary:hover { background:var(--blue-dark); }
.btn-secondary { background:var(--surface2); color:var(--text2); border:1px solid var(--border); }
.btn-secondary:hover { background:var(--border-light); }
.btn-success { background:var(--green); color:#fff; }
.btn-success:hover { background:#15803d; }
.btn-danger { background:var(--red); color:#fff; }
.btn-danger:hover { background:#b91c1c; }
.notif-btn {
  width:34px; height:34px; border-radius:6px; background:var(--surface2);
  border:1px solid var(--border); display:flex; align-items:center;
  justify-content:center; cursor:pointer; position:relative;
}
.notif-dot {
  position:absolute; top:6px; right:6px; width:7px; height:7px;
  background:var(--red); border-radius:50%; border:1.5px solid var(--surface);
}

/* CONTENT */
.content { padding:24px 28px; flex:1; }

/* SCREEN ‚Äì hidden by default */
.screen { display:none; }
.screen.active { display:block; }

/* SUMMARY CARDS */
.cards-grid { display:grid; grid-template-columns:repeat(6,1fr); gap:14px; margin-bottom:24px; }
.card {
  background:var(--surface); border-radius:var(--radius); border:1px solid var(--border);
  padding:16px; box-shadow:var(--shadow); transition:box-shadow 0.15s;
}
.card:hover { box-shadow:var(--shadow-md); }
.card-label { font-size:11px; font-weight:600; color:var(--text2); text-transform:uppercase; letter-spacing:0.5px; margin-bottom:8px; }
.card-value { font-size:26px; font-weight:700; letter-spacing:-1px; color:var(--text); line-height:1; }
.card-sub { font-size:11px; color:var(--text3); margin-top:5px; }
.card-icon { font-size:20px; margin-bottom:6px; }
.card.blue .card-value { color:var(--blue); }
.card.green .card-value { color:var(--green); }
.card.red .card-value { color:var(--red); }
.card.yellow .card-value { color:var(--yellow); }
.card.accent { background:var(--blue); border-color:var(--blue); }
.card.accent .card-label, .card.accent .card-sub, .card.accent .card-value { color:#fff; }

/* TABLE */
.table-card {
  background:var(--surface); border-radius:var(--radius); border:1px solid var(--border);
  box-shadow:var(--shadow); overflow:hidden;
}
.table-header {
  padding:16px 20px; border-bottom:1px solid var(--border);
  display:flex; align-items:center; justify-content:space-between;
}
.table-title { font-size:14px; font-weight:700; color:var(--text); }
.table-actions { display:flex; gap:8px; align-items:center; }
.search-input {
  padding:6px 12px 6px 30px; border-radius:6px; border:1px solid var(--border);
  font-family:'DM Sans',sans-serif; font-size:12px; background:var(--surface2);
  outline:none; width:200px; color:var(--text);
}
.search-wrap { position:relative; }
.search-icon { position:absolute; left:9px; top:50%; transform:translateY(-50%); color:var(--text3); font-size:12px; }

table { width:100%; border-collapse:collapse; }
th {
  background:var(--surface2); border-bottom:1px solid var(--border);
  padding:10px 16px; text-align:left; font-size:11px; font-weight:700;
  color:var(--text2); text-transform:uppercase; letter-spacing:0.5px;
  white-space:nowrap;
}
td { padding:12px 16px; border-bottom:1px solid var(--border-light); font-size:13px; color:var(--text); vertical-align:middle; }
tr:last-child td { border-bottom:none; }
tr:hover td { background:var(--surface2); }

/* STATUS BADGES */
.badge {
  display:inline-flex; align-items:center; gap:4px;
  padding:3px 9px; border-radius:20px; font-size:11px; font-weight:700; letter-spacing:0.2px;
}
.badge::before { content:''; width:5px; height:5px; border-radius:50%; }
.badge.review { background:#fef3c7; color:#92400e; }
.badge.review::before { background:#d97706; }
.badge.approved { background:var(--green-light); color:#14532d; }
.badge.approved::before { background:var(--green); }
.badge.rejected { background:var(--red-light); color:#7f1d1d; }
.badge.rejected::before { background:var(--red); }
.badge.active { background:#dbeafe; color:#1e3a8a; }
.badge.active::before { background:var(--blue); }
.badge.pending { background:#f3f4f6; color:#374151; }
.badge.pending::before { background:#9ca3af; }
.badge.expiring { background:#fef3c7; color:#92400e; }
.badge.expiring::before { background:#d97706; }
.badge.signed { background:var(--green-light); color:#14532d; }
.badge.signed::before { background:var(--green); }

/* RISK SCORE */
.risk-score {
  display:inline-flex; align-items:center; gap:4px;
  font-family:'DM Mono',monospace; font-size:12px; font-weight:500;
}
.risk-low { color:var(--green); }
.risk-med { color:var(--yellow); }
.risk-high { color:var(--red); }
.risk-bar { height:4px; border-radius:2px; display:inline-block; margin-left:4px; }

/* ACTION BUTTONS */
.btn-sm {
  padding:5px 12px; border-radius:5px; font-size:11px; font-weight:600;
  cursor:pointer; border:none; font-family:'DM Sans',sans-serif; transition:all 0.12s;
}
.btn-view { background:var(--blue-light); color:var(--blue); }
.btn-view:hover { background:#bfdbfe; }
.btn-edit { background:#f3f4f6; color:var(--text2); border:1px solid var(--border); }
.btn-edit:hover { background:var(--border); }

/* FORM */
.form-card {
  background:var(--surface); border-radius:var(--radius); border:1px solid var(--border);
  box-shadow:var(--shadow); padding:24px;
}
.form-section-title { font-size:13px; font-weight:700; color:var(--text); margin-bottom:16px; border-bottom:1px solid var(--border-light); padding-bottom:10px; }
.form-grid { display:grid; grid-template-columns:1fr 1fr; gap:16px; }
.form-group { display:flex; flex-direction:column; gap:5px; }
.form-group.full { grid-column:1/-1; }
label { font-size:11px; font-weight:700; color:var(--text2); text-transform:uppercase; letter-spacing:0.4px; }
input, select, textarea {
  padding:9px 12px; border-radius:6px; border:1px solid var(--border);
  font-family:'DM Sans',sans-serif; font-size:13px; background:var(--surface);
  color:var(--text); outline:none; transition:border-color 0.15s;
}
input:focus, select:focus, textarea:focus { border-color:var(--blue); box-shadow:0 0 0 3px rgba(37,99,235,0.1); }
textarea { resize:vertical; min-height:90px; }
.form-actions { display:flex; gap:10px; margin-top:20px; justify-content:flex-end; }

/* PANELS */
.panel-grid { display:grid; grid-template-columns:1fr 320px; gap:20px; }
.panel-card {
  background:var(--surface); border-radius:var(--radius); border:1px solid var(--border);
  box-shadow:var(--shadow); padding:20px; margin-bottom:16px;
}
.panel-title { font-size:13px; font-weight:700; color:var(--text); margin-bottom:14px; display:flex; align-items:center; gap:6px; }

/* METRICS */
.metrics-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:12px; }
.metric-item { background:var(--surface2); border-radius:6px; padding:14px; border:1px solid var(--border-light); }
.metric-val { font-size:22px; font-weight:700; letter-spacing:-0.5px; }
.metric-label { font-size:11px; color:var(--text2); margin-top:2px; font-weight:500; }

/* CUSTOMER SUMMARY */
.customer-card {
  background:linear-gradient(135deg,#1e3a8a 0%,#2563eb 100%);
  border-radius:var(--radius); padding:20px; color:#fff; margin-bottom:16px;
}
.customer-name { font-size:20px; font-weight:700; letter-spacing:-0.5px; }
.customer-meta { font-size:12px; opacity:0.8; margin-top:4px; }
.customer-tags { display:flex; gap:8px; margin-top:12px; }
.customer-tag {
  background:rgba(255,255,255,0.15); border-radius:4px;
  padding:3px 10px; font-size:11px; font-weight:600; backdrop-filter:blur(4px);
}

/* DECISION PANEL */
.decision-panel { position:sticky; top:80px; }
.decision-card {
  background:var(--surface); border-radius:var(--radius); border:1px solid var(--border);
  box-shadow:var(--shadow-md); overflow:hidden;
}
.decision-header { background:var(--sidebar); padding:14px 18px; color:#f8fafc; font-size:13px; font-weight:700; }
.decision-body { padding:18px; }
.score-display {
  text-align:center; padding:20px 0;
  border-bottom:1px solid var(--border-light); margin-bottom:16px;
}
.score-ring {
  width:100px; height:100px; border-radius:50%; margin:0 auto 10px;
  display:flex; align-items:center; justify-content:center;
  font-size:28px; font-weight:700; font-family:'DM Mono',monospace;
  position:relative;
}
.score-ring.low { background:var(--green-light); color:var(--green); border:4px solid var(--green); }
.score-ring.med { background:var(--yellow-light); color:var(--yellow); border:4px solid var(--yellow); }
.score-ring.high { background:var(--red-light); color:var(--red); border:4px solid var(--red); }
.score-label { font-size:11px; color:var(--text2); font-weight:600; }
.decision-actions { display:flex; flex-direction:column; gap:8px; }
.btn-full { width:100%; padding:10px; border-radius:6px; font-size:13px; font-weight:700; cursor:pointer; border:none; font-family:'DM Sans',sans-serif; transition:all 0.15s; }
.btn-approve { background:var(--green); color:#fff; }
.btn-approve:hover { background:#15803d; }
.btn-reject { background:var(--red-light); color:var(--red); border:1px solid #fca5a5; }
.btn-reject:hover { background:#fecaca; }

/* TIMELINE */
.timeline { position:relative; padding-left:20px; }
.timeline::before { content:''; position:absolute; left:7px; top:0; bottom:0; width:2px; background:var(--border); }
.timeline-item { position:relative; margin-bottom:14px; }
.timeline-dot { position:absolute; left:-17px; top:3px; width:10px; height:10px; border-radius:50%; border:2px solid var(--surface); }
.timeline-dot.green { background:var(--green); }
.timeline-dot.blue { background:var(--blue); }
.timeline-dot.yellow { background:var(--yellow); }
.timeline-dot.red { background:var(--red); }
.timeline-dot.grey { background:var(--text3); }
.timeline-text { font-size:12px; color:var(--text2); }
.timeline-time { font-size:10px; color:var(--text3); margin-top:1px; }

/* SLA COLORS */
.sla-good { color:var(--green); font-weight:700; }
.sla-risk { color:var(--yellow); font-weight:700; }
.sla-breach { color:var(--red); font-weight:700; }
.sla-bar-wrap { display:flex; align-items:center; gap:8px; }
.sla-bar-bg { height:6px; background:var(--border); border-radius:3px; flex:1; overflow:hidden; }
.sla-bar-fill { height:100%; border-radius:3px; }

/* MODAL */
.modal-overlay {
  display:none; position:fixed; inset:0; background:rgba(0,0,0,0.4);
  z-index:1000; align-items:center; justify-content:center; backdrop-filter:blur(2px);
}
.modal-overlay.show { display:flex; }
.modal {
  background:var(--surface); border-radius:10px; box-shadow:var(--shadow-lg);
  width:480px; overflow:hidden; animation:modalIn 0.2s ease;
}
@keyframes modalIn { from { transform:scale(0.95); opacity:0; } to { transform:scale(1); opacity:1; } }
.modal-header { padding:18px 20px; border-bottom:1px solid var(--border); display:flex; align-items:center; justify-content:space-between; }
.modal-title { font-size:14px; font-weight:700; }
.modal-close { cursor:pointer; color:var(--text3); font-size:18px; line-height:1; }
.modal-body { padding:20px; }
.modal-footer { padding:14px 20px; border-top:1px solid var(--border); display:flex; justify-content:flex-end; gap:8px; }

/* TOAST */
.toast {
  position:fixed; bottom:24px; right:24px; z-index:2000;
  background:var(--sidebar); color:#f8fafc; padding:12px 18px;
  border-radius:8px; font-size:13px; font-weight:500; box-shadow:var(--shadow-lg);
  display:none; align-items:center; gap:8px; animation:toastIn 0.2s ease;
}
.toast.show { display:flex; }
@keyframes toastIn { from { transform:translateY(10px); opacity:0; } to { transform:translateY(0); opacity:1; } }

/* AUDIT LOG */
.audit-row { display:flex; gap:10px; padding:10px 0; border-bottom:1px solid var(--border-light); font-size:12px; }
.audit-time { color:var(--text3); font-family:'DM Mono',monospace; white-space:nowrap; min-width:130px; }
.audit-user { color:var(--blue); font-weight:600; }
.audit-action { color:var(--text); }

/* CONTRACT SCREEN */
.contract-header {
  background:var(--surface); border:1px solid var(--border); border-radius:var(--radius);
  padding:20px; margin-bottom:20px; display:flex; align-items:center; justify-content:space-between;
}
.approval-badge {
  display:inline-flex; align-items:center; gap:6px;
  background:var(--green-light); color:var(--green); border:1px solid #86efac;
  border-radius:6px; padding:6px 14px; font-size:12px; font-weight:700;
}

/* BILLING */
.billing-row {
  display:flex; align-items:center; justify-content:space-between;
  padding:14px 0; border-bottom:1px solid var(--border-light);
}
.billing-row:last-child { border-bottom:none; }

/* PROGRESS BAR */
.progress-bar { height:8px; background:var(--border); border-radius:4px; overflow:hidden; margin-top:6px; }
.progress-fill { height:100%; border-radius:4px; background:var(--blue); }

/* AI CHIP */
.ai-chip {
  display:inline-flex; align-items:center; gap:5px;
  background:linear-gradient(135deg,#4f46e5,#7c3aed); color:#fff;
  border-radius:4px; padding:3px 8px; font-size:10px; font-weight:700; letter-spacing:0.3px;
}

/* EXPIRY ALERT */
.alert-banner {
  display:flex; align-items:center; gap:10px;
  background:#fffbeb; border:1px solid #fcd34d; border-radius:var(--radius);
  padding:12px 16px; margin-bottom:20px; font-size:13px; color:#92400e;
}

/* TABS */
.tabs { display:flex; gap:2px; background:var(--surface2); border-radius:6px; padding:3px; margin-bottom:20px; width:fit-content; }
.tab-btn {
  padding:7px 16px; border-radius:5px; font-size:12px; font-weight:600;
  cursor:pointer; border:none; background:transparent; color:var(--text2);
  font-family:'DM Sans',sans-serif; transition:all 0.15s;
}
.tab-btn.active { background:var(--surface); color:var(--text); box-shadow:var(--shadow); }

/* PROFITABILITY */
.profit-item { display:flex; justify-content:space-between; align-items:center; padding:10px 0; border-bottom:1px solid var(--border-light); font-size:13px; }
.profit-val { font-weight:700; font-family:'DM Mono',monospace; }

/* SECTION HEADER */
.section-header { display:flex; align-items:center; justify-content:space-between; margin-bottom:16px; }
.section-title { font-size:15px; font-weight:700; color:var(--text); }

/* ACCESS DENIED */
.access-denied {
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  height:300px; gap:12px;
}
.access-icon { font-size:48px; }
.access-text { font-size:14px; color:var(--text2); text-align:center; }

/* UTIL */
.text-mono { font-family:'DM Mono',monospace; }
.flex { display:flex; }
.items-center { align-items:center; }
.gap-8 { gap:8px; }
.mt-16 { margin-top:16px; }
.mt-20 { margin-top:20px; }
.text-sm { font-size:12px; }
.text-xs { font-size:11px; }
.text-muted { color:var(--text2); }
.fw-700 { font-weight:700; }
.divider { border:none; border-top:1px solid var(--border); margin:16px 0; }
</style>
</head>
<body>

<!-- SIDEBAR -->
<aside class="sidebar">
  <div class="sidebar-logo">
    <div class="logo-mark">
      <div class="logo-icon">üöõ</div>
      <div>
        <div class="logo-text">FleetCare Pro</div>
        <div class="logo-sub">Contract Management System</div>
      </div>
    </div>
  </div>

  <div class="role-section">
    <div class="role-label">Logged in as</div>
    <select class="role-selector" id="roleSelect" onchange="changeRole(this.value)">
      <option value="admin">üîë Admin</option>
      <option value="handler">üßë‚Äçüíº Customer Handler</option>
      <option value="executive">üë§ Care Executive</option>
    </select>
  </div>

  <nav class="sidebar-nav">
    <div class="nav-section-label">Main</div>
    <div class="nav-item active" onclick="navigate('dashboard',this)" data-screen="dashboard" data-roles="admin,handler,executive">
      <span class="icon">üìä</span> Dashboard
    </div>
    <div class="nav-item" onclick="navigate('leads',this)" data-screen="leads" data-roles="admin,handler,executive">
      <span class="icon">üìã</span> Leads <span class="nav-badge">7</span>
    </div>
    <div class="nav-item" onclick="navigate('customers',this)" data-screen="customers" data-roles="admin,handler,executive">
      <span class="icon">üè¢</span> Customer Database
    </div>

    <div class="nav-section-label">Operations</div>
    <div class="nav-item" onclick="navigate('review',this)" data-screen="review" data-roles="admin,handler">
      <span class="icon">üîç</span> Performance Review
    </div>
    <div class="nav-item" onclick="navigate('contracts',this)" data-screen="contracts" data-roles="admin,handler">
      <span class="icon">üìÑ</span> Contract Management
    </div>
    <div class="nav-item" onclick="navigate('billing',this)" data-screen="billing" data-roles="admin,handler">
      <span class="icon">üí∞</span> Billing Schedule
    </div>
    <div class="nav-item" onclick="navigate('sla',this)" data-screen="sla" data-roles="admin,handler,executive">
      <span class="icon">üéØ</span> SLA Monitoring
    </div>

    <div class="nav-section-label">Analytics</div>
    <div class="nav-item" onclick="navigate('reports',this)" data-screen="reports" data-roles="admin">
      <span class="icon">üìà</span> Reports
    </div>
    <div class="nav-item" onclick="navigate('settings',this)" data-screen="settings" data-roles="admin">
      <span class="icon">‚öôÔ∏è</span> Settings
    </div>
  </nav>

  <div class="sidebar-user">
    <div class="user-avatar" id="userAvatar">A</div>
    <div>
      <div class="user-name" id="userName">Admin User</div>
      <div class="user-role-tag" id="userRoleTag">System Administrator</div>
    </div>
  </div>
</aside>

<!-- MAIN -->
<main class="main">
  <div class="topbar">
    <div class="topbar-left">
      <div class="page-title" id="pageTitle">Dashboard</div>
      <div class="breadcrumb" id="breadcrumb">Overview</div>
    </div>
    <div class="topbar-right">
      <div class="notif-btn">üîî<div class="notif-dot"></div></div>
      <button class="topbar-btn btn-primary" onclick="navigate('leads-new',null)" id="topbarAction">+ New Lead</button>
    </div>
  </div>

  <div class="content">

    <!-- ============ DASHBOARD ============ -->
    <div class="screen active" id="screen-dashboard">
      <div class="alert-banner">
        ‚ö†Ô∏è <strong>3 contracts expiring within 30 days.</strong> Review and initiate renewal process.
        <button class="btn-sm btn-view" style="margin-left:auto" onclick="navigate('contracts',null)">View Contracts</button>
      </div>

      <div class="cards-grid">
        <div class="card blue" onclick="navigate('leads',null)" style="cursor:pointer">
          <div class="card-icon">üìã</div>
          <div class="card-label">New Leads</div>
          <div class="card-value">24</div>
          <div class="card-sub">‚Üë 4 today</div>
        </div>
        <div class="card yellow">
          <div class="card-icon">üîç</div>
          <div class="card-label">Under Review</div>
          <div class="card-value">7</div>
          <div class="card-sub">Avg 2.3 days</div>
        </div>
        <div class="card green">
          <div class="card-icon">‚úÖ</div>
          <div class="card-label">Approved</div>
          <div class="card-value">18</div>
          <div class="card-sub">This month</div>
        </div>
        <div class="card red">
          <div class="card-icon">‚ùå</div>
          <div class="card-label">Rejected</div>
          <div class="card-value">5</div>
          <div class="card-sub">This month</div>
        </div>
        <div class="card accent">
          <div class="card-icon">üöõ</div>
          <div class="card-label">Active Contracts</div>
          <div class="card-value">142</div>
          <div class="card-sub">‚Üë 6 new this week</div>
        </div>
        <div class="card yellow">
          <div class="card-icon">‚è∞</div>
          <div class="card-label">Expiring Soon</div>
          <div class="card-value">3</div>
          <div class="card-sub">Within 30 days</div>
        </div>
      </div>

      <div class="section-header">
        <div class="section-title">Lead Overview</div>
        <div class="flex gap-8">
          <div class="search-wrap">
            <span class="search-icon">üîç</span>
            <input class="search-input" placeholder="Search leads..." style="padding-left:30px">
          </div>
          <select style="padding:6px 10px;border-radius:6px;border:1px solid var(--border);font-family:'DM Sans',sans-serif;font-size:12px;color:var(--text2);background:var(--surface2)">
            <option>All Status</option>
            <option>Under Review</option>
            <option>Approved</option>
            <option>Rejected</option>
          </select>
        </div>
      </div>

      <div class="table-card">
        <table>
          <thead>
            <tr>
              <th>Lead ID</th>
              <th>Company Name</th>
              <th>Fleet Size</th>
              <th>Risk Score <span class="ai-chip">AI</span></th>
              <th>Status</th>
              <th>Assigned Handler</th>
              <th>Created</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-mono" style="color:var(--blue);font-weight:600">LD-2024-0089</td>
              <td><div style="font-weight:600">Apex Logistics Ltd.</div><div class="text-xs text-muted">Mumbai, Maharashtra</div></td>
              <td>48 vehicles</td>
              <td><span class="risk-score risk-low">22 <span class="risk-bar" style="width:30px;background:var(--green)"></span></span></td>
              <td><span class="badge approved">Approved</span></td>
              <td>Rahul M.</td>
              <td>12 Feb 2025</td>
              <td><button class="btn-sm btn-view" onclick="navigate('review',null)">View</button></td>
            </tr>
            <tr>
              <td class="text-mono" style="color:var(--blue);font-weight:600">LD-2024-0088</td>
              <td><div style="font-weight:600">SwiftTrans India</div><div class="text-xs text-muted">Delhi NCR</div></td>
              <td>120 vehicles</td>
              <td><span class="risk-score risk-med">58 <span class="risk-bar" style="width:30px;background:var(--yellow)"></span></span></td>
              <td><span class="badge review">Under Review</span></td>
              <td>Priya K.</td>
              <td>14 Feb 2025</td>
              <td><button class="btn-sm btn-view" onclick="navigate('review',null)">View</button></td>
            </tr>
            <tr>
              <td class="text-mono" style="color:var(--blue);font-weight:600">LD-2024-0087</td>
              <td><div style="font-weight:600">National Fleet Services</div><div class="text-xs text-muted">Chennai, TN</div></td>
              <td>200 vehicles</td>
              <td><span class="risk-score risk-high">81 <span class="risk-bar" style="width:30px;background:var(--red)"></span></span></td>
              <td><span class="badge rejected">Rejected</span></td>
              <td>Arjun S.</td>
              <td>10 Feb 2025</td>
              <td><button class="btn-sm btn-view" onclick="navigate('review',null)">View</button></td>
            </tr>
            <tr>
              <td class="text-mono" style="color:var(--blue);font-weight:600">LD-2024-0086</td>
              <td><div style="font-weight:600">Green Mile Cargo</div><div class="text-xs text-muted">Pune, Maharashtra</div></td>
              <td>35 vehicles</td>
              <td><span class="risk-score risk-low">15 <span class="risk-bar" style="width:30px;background:var(--green)"></span></span></td>
              <td><span class="badge review">Under Review</span></td>
              <td>Rahul M.</td>
              <td>15 Feb 2025</td>
              <td><button class="btn-sm btn-view" onclick="navigate('review',null)">View</button></td>
            </tr>
            <tr>
              <td class="text-mono" style="color:var(--blue);font-weight:600">LD-2024-0085</td>
              <td><div style="font-weight:600">Metro Movers Co.</div><div class="text-xs text-muted">Hyderabad, TS</div></td>
              <td>67 vehicles</td>
              <td><span class="risk-score risk-med">44 <span class="risk-bar" style="width:30px;background:var(--yellow)"></span></span></td>
              <td><span class="badge active">Active</span></td>
              <td>Priya K.</td>
              <td>8 Feb 2025</td>
              <td><button class="btn-sm btn-view" onclick="navigate('contracts',null)">View</button></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- ============ LEADS LIST ============ -->
    <div class="screen" id="screen-leads">
      <div class="section-header">
        <div class="section-title">All Leads</div>
        <button class="topbar-btn btn-primary" onclick="navigate('leads-new',null)">+ Create New Lead</button>
      </div>

      <div class="tabs">
        <button class="tab-btn active">All (24)</button>
        <button class="tab-btn">Under Review (7)</button>
        <button class="tab-btn">Approved (18)</button>
        <button class="tab-btn">Rejected (5)</button>
      </div>

      <div class="table-card">
        <table>
          <thead>
            <tr>
              <th>Lead ID</th>
              <th>Company Name</th>
              <th>Fleet Size</th>
              <th>Contact</th>
              <th>Risk Score</th>
              <th>Status</th>
              <th>Handler</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-mono" style="color:var(--blue);font-weight:600">LD-2024-0089</td>
              <td><div style="font-weight:600">Apex Logistics Ltd.</div><div class="text-xs text-muted">Mumbai</div></td>
              <td>48</td>
              <td>Rajesh Kumar</td>
              <td><span class="risk-score risk-low">22</span></td>
              <td><span class="badge approved">Approved</span></td>
              <td>Rahul M.</td>
              <td><button class="btn-sm btn-view" onclick="navigate('review',null)">Review</button></td>
            </tr>
            <tr>
              <td class="text-mono" style="color:var(--blue);font-weight:600">LD-2024-0088</td>
              <td><div style="font-weight:600">SwiftTrans India</div><div class="text-xs text-muted">Delhi</div></td>
              <td>120</td>
              <td>Suresh Patel</td>
              <td><span class="risk-score risk-med">58</span></td>
              <td><span class="badge review">Under Review</span></td>
              <td>Priya K.</td>
              <td><button class="btn-sm btn-view" onclick="navigate('review',null)">Review</button></td>
            </tr>
            <tr>
              <td class="text-mono" style="color:var(--blue);font-weight:600">LD-2024-0087</td>
              <td><div style="font-weight:600">National Fleet Services</div><div class="text-xs text-muted">Chennai</div></td>
              <td>200</td>
              <td>Anita Sharma</td>
              <td><span class="risk-score risk-high">81</span></td>
              <td><span class="badge rejected">Rejected</span></td>
              <td>Arjun S.</td>
              <td><button class="btn-sm btn-view" onclick="navigate('review',null)">Review</button></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- ============ NEW LEAD FORM ============ -->
    <div class="screen" id="screen-leads-new">
      <div class="form-card">
        <div class="form-section-title">Company Information</div>
        <div class="form-grid">
          <div class="form-group">
            <label>Company Name *</label>
            <input type="text" placeholder="e.g. Apex Logistics Ltd.">
          </div>
          <div class="form-group">
            <label>Contact Person *</label>
            <input type="text" placeholder="Full name">
          </div>
          <div class="form-group">
            <label>Phone Number *</label>
            <input type="tel" placeholder="+91 98765 43210">
          </div>
          <div class="form-group">
            <label>Email Address *</label>
            <input type="email" placeholder="contact@company.com">
          </div>
          <div class="form-group full">
            <label>Business Address</label>
            <input type="text" placeholder="Full address with city and state">
          </div>
        </div>

        <hr class="divider">
        <div class="form-section-title" style="margin-top:0">Fleet & Contract Details</div>
        <div class="form-grid">
          <div class="form-group">
            <label>Fleet Size *</label>
            <input type="number" placeholder="Number of vehicles">
          </div>
          <div class="form-group">
            <label>Vehicle Types</label>
            <input type="text" placeholder="HCV, LCV, Buses...">
          </div>
          <div class="form-group">
            <label>Service Location</label>
            <input type="text" placeholder="City / State">
          </div>
          <div class="form-group">
            <label>Preferred Contract Duration</label>
            <select>
              <option>Select duration</option>
              <option>6 Months</option>
              <option>1 Year</option>
              <option>2 Years</option>
              <option>3 Years</option>
              <option>Custom</option>
            </select>
          </div>
          <div class="form-group">
            <label>Expected Start Date</label>
            <input type="date">
          </div>
          <div class="form-group">
            <label>Assign Handler</label>
            <select>
              <option>Auto Assign</option>
              <option>Rahul Mehta</option>
              <option>Priya Kapoor</option>
              <option>Arjun Singh</option>
            </select>
          </div>
          <div class="form-group full">
            <label>Special Requirements</label>
            <textarea placeholder="Any specific maintenance requirements, service level expectations, or additional notes..."></textarea>
          </div>
        </div>

        <div style="background:var(--blue-light);border-radius:6px;padding:12px 16px;margin-top:16px;font-size:12px;color:#1e40af;display:flex;gap:8px;align-items:flex-start">
          <span>ü§ñ</span>
          <span><strong>AI Risk Scoring</strong> will be automatically calculated based on fleet size, company history, and service patterns after lead submission.</span>
        </div>

        <div class="form-actions">
          <button class="topbar-btn btn-secondary" onclick="navigate('leads',null)">Cancel</button>
          <button class="topbar-btn btn-primary" onclick="submitLead()">Generate Lead ‚Üí</button>
        </div>
      </div>
    </div>

    <!-- ============ PERFORMANCE REVIEW ============ -->
    <div class="screen" id="screen-review">
      <div class="customer-card">
        <div style="display:flex;align-items:center;justify-content:space-between">
          <div>
            <div style="font-size:11px;opacity:0.7;font-weight:600;letter-spacing:0.5px;text-transform:uppercase;margin-bottom:4px">Lead LD-2024-0089</div>
            <div class="customer-name">Apex Logistics Ltd.</div>
            <div class="customer-meta">üìç Mumbai, Maharashtra &nbsp;|&nbsp; üë§ Rajesh Kumar &nbsp;|&nbsp; üìû +91 98765 43210</div>
          </div>
          <div style="text-align:right">
            <div style="font-size:11px;opacity:0.7;margin-bottom:4px">Existing Customer</div>
            <div style="font-size:22px;font-weight:700">48 Vehicles</div>
            <div style="font-size:12px;opacity:0.8">HCV, LCV Fleet</div>
          </div>
        </div>
        <div class="customer-tags">
          <span class="customer-tag">‚≠ê 3-Year Relationship</span>
          <span class="customer-tag">‚úÖ Payment: Excellent</span>
          <span class="customer-tag">ü§ñ AI Score: 22/100</span>
          <span class="customer-tag">üìä Risk: Low</span>
        </div>
      </div>

      <div class="panel-grid">
        <div>
          <div class="panel-card">
            <div class="panel-title">üìä Performance Analytics</div>
            <div class="metrics-grid">
              <div class="metric-item">
                <div class="metric-val" style="color:var(--green)">96.4%</div>
                <div class="metric-label">SLA Compliance</div>
              </div>
              <div class="metric-item">
                <div class="metric-val" style="color:var(--blue)">‚Çπ42.8L</div>
                <div class="metric-label">Total Revenue</div>
              </div>
              <div class="metric-item">
                <div class="metric-val" style="color:var(--green)">0</div>
                <div class="metric-label">Open Disputes</div>
              </div>
              <div class="metric-item">
                <div class="metric-val">1.2%</div>
                <div class="metric-label">Downtime %</div>
              </div>
              <div class="metric-item">
                <div class="metric-val" style="color:var(--yellow)">3</div>
                <div class="metric-label">SLA Violations</div>
              </div>
              <div class="metric-item">
                <div class="metric-val" style="color:var(--green)">100%</div>
                <div class="metric-label">Payment Rate</div>
              </div>
            </div>
          </div>

          <div class="panel-card">
            <div class="panel-title">üìã Contract History</div>
            <table style="width:100%">
              <thead>
                <tr>
                  <th style="padding:8px 0;font-size:10px">Contract ID</th>
                  <th style="padding:8px 0;font-size:10px">Period</th>
                  <th style="padding:8px 0;font-size:10px">Value</th>
                  <th style="padding:8px 0;font-size:10px">Status</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td style="padding:10px 0;font-family:'DM Mono',monospace;font-size:12px;color:var(--blue)">CT-2023-0041</td>
                  <td style="padding:10px 0;font-size:12px">Jan‚ÄìDec 2023</td>
                  <td style="padding:10px 0;font-size:12px;font-weight:600">‚Çπ14.2L</td>
                  <td style="padding:10px 0"><span class="badge signed">Completed</span></td>
                </tr>
                <tr>
                  <td style="padding:10px 0;font-family:'DM Mono',monospace;font-size:12px;color:var(--blue)">CT-2022-0018</td>
                  <td style="padding:10px 0;font-size:12px">Jan‚ÄìDec 2022</td>
                  <td style="padding:10px 0;font-size:12px;font-weight:600">‚Çπ12.6L</td>
                  <td style="padding:10px 0"><span class="badge signed">Completed</span></td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="panel-card">
            <div class="panel-title">üïê Audit Log</div>
            <div class="audit-row">
              <div class="audit-time">15 Feb 2025 10:23</div>
              <div><span class="audit-user">Rahul M.</span> <span class="audit-action">submitted lead for review</span></div>
            </div>
            <div class="audit-row">
              <div class="audit-time">15 Feb 2025 11:40</div>
              <div><span class="audit-user">System</span> <span class="audit-action">AI Risk Score calculated: 22 (Low)</span></div>
            </div>
            <div class="audit-row">
              <div class="audit-time">15 Feb 2025 14:12</div>
              <div><span class="audit-user">Admin</span> <span class="audit-action">assigned to Rahul M. for review</span></div>
            </div>
          </div>
        </div>

        <!-- DECISION PANEL -->
        <div class="decision-panel">
          <div class="decision-card">
            <div class="decision-header">ü§ñ AI Decision Panel</div>
            <div class="decision-body">
              <div class="score-display">
                <div class="score-ring low">22</div>
                <div class="score-label">Risk Score ¬∑ LOW RISK</div>
                <div style="font-size:11px;color:var(--text3);margin-top:4px">AI Recommendation: <strong style="color:var(--green)">Approve</strong></div>
              </div>

              <div style="font-size:12px;color:var(--text2);margin-bottom:14px">
                <div style="font-weight:700;color:var(--text);margin-bottom:8px">AI Analysis Summary</div>
                <div class="timeline">
                  <div class="timeline-item">
                    <div class="timeline-dot green"></div>
                    <div class="timeline-text">Payment history: Excellent (100%)</div>
                    <div class="timeline-time">Positive factor</div>
                  </div>
                  <div class="timeline-item">
                    <div class="timeline-dot green"></div>
                    <div class="timeline-text">3-year client relationship</div>
                    <div class="timeline-time">Positive factor</div>
                  </div>
                  <div class="timeline-item">
                    <div class="timeline-dot yellow"></div>
                    <div class="timeline-text">3 minor SLA violations</div>
                    <div class="timeline-time">Minor concern</div>
                  </div>
                  <div class="timeline-item">
                    <div class="timeline-dot green"></div>
                    <div class="timeline-text">Fleet size: Manageable</div>
                    <div class="timeline-time">Positive factor</div>
                  </div>
                </div>
              </div>

              <div style="margin-bottom:14px">
                <div style="font-size:11px;font-weight:700;color:var(--text2);text-transform:uppercase;letter-spacing:0.4px;margin-bottom:6px">Profitability Projection</div>
                <div class="profit-item">
                  <span>Estimated Annual Value</span>
                  <span class="profit-val" style="color:var(--green)">‚Çπ16.8L</span>
                </div>
                <div class="profit-item">
                  <span>Margin %</span>
                  <span class="profit-val">34%</span>
                </div>
                <div class="profit-item">
                  <span>Renewal Probability</span>
                  <span class="profit-val" style="color:var(--blue)">87%</span>
                </div>
              </div>

              <div class="decision-actions" id="decisionActions">
                <button class="btn-full btn-approve" onclick="approveLeadAction()">‚úÖ Approve Lead</button>
                <button class="btn-full btn-reject" onclick="showRejectModal()">‚ùå Reject Lead</button>
              </div>
              <div id="decisionResult" style="display:none;text-align:center;padding:12px;border-radius:6px"></div>

              <div style="margin-top:14px;padding-top:14px;border-top:1px solid var(--border-light)">
                <div style="font-size:11px;font-weight:700;color:var(--text2);text-transform:uppercase;letter-spacing:0.4px;margin-bottom:8px">Handler Notes</div>
                <textarea placeholder="Add notes about this lead..." style="width:100%;font-size:12px;min-height:70px"></textarea>
                <button class="btn-sm btn-view" style="margin-top:6px;width:100%">Save Note</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ============ CUSTOMERS ============ -->
    <div class="screen" id="screen-customers">
      <div class="section-header">
        <div class="section-title">Customer Database</div>
        <div class="search-wrap">
          <span class="search-icon">üîç</span>
          <input class="search-input" placeholder="Search customers..." style="padding-left:30px;width:250px">
        </div>
      </div>
      <div class="table-card">
        <table>
          <thead>
            <tr>
              <th>Customer ID</th>
              <th>Company</th>
              <th>Fleet Size</th>
              <th>Total Contracts</th>
              <th>Total Value</th>
              <th>Risk Score</th>
              <th>Status</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-mono" style="color:var(--blue);font-weight:600">CX-0001</td>
              <td><div style="font-weight:600">Apex Logistics Ltd.</div><div class="text-xs text-muted">Mumbai</div></td>
              <td>48</td>
              <td>3</td>
              <td style="font-weight:700;font-family:'DM Mono',monospace">‚Çπ42.8L</td>
              <td><span class="risk-score risk-low">22</span></td>
              <td><span class="badge active">Active</span></td>
              <td><button class="btn-sm btn-view">Profile</button></td>
            </tr>
            <tr>
              <td class="text-mono" style="color:var(--blue);font-weight:600">CX-0002</td>
              <td><div style="font-weight:600">Metro Movers Co.</div><div class="text-xs text-muted">Hyderabad</div></td>
              <td>67</td>
              <td>1</td>
              <td style="font-weight:700;font-family:'DM Mono',monospace">‚Çπ18.4L</td>
              <td><span class="risk-score risk-med">44</span></td>
              <td><span class="badge active">Active</span></td>
              <td><button class="btn-sm btn-view">Profile</button></td>
            </tr>
            <tr>
              <td class="text-mono" style="color:var(--blue);font-weight:600">CX-0003</td>
              <td><div style="font-weight:600">SunRise Transport</div><div class="text-xs text-muted">Bangalore</div></td>
              <td>22</td>
              <td>2</td>
              <td style="font-weight:700;font-family:'DM Mono',monospace">‚Çπ9.2L</td>
              <td><span class="risk-score risk-low">18</span></td>
              <td><span class="badge expiring">Expiring</span></td>
              <td><button class="btn-sm btn-view">Profile</button></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- ============ CONTRACT CREATION ============ -->
    <div class="screen" id="screen-contracts">
      <div class="alert-banner" style="margin-bottom:16px">
        üîí Contract creation is only available for <strong>Approved</strong> leads. Ensure lead status is Approved before proceeding.
      </div>

      <div class="contract-header">
        <div>
          <div style="font-size:11px;color:var(--text2);font-weight:600;text-transform:uppercase;letter-spacing:0.5px;margin-bottom:4px">Creating Contract for Lead LD-2024-0089</div>
          <div style="font-size:16px;font-weight:700">Apex Logistics Ltd.</div>
          <div style="font-size:12px;color:var(--text2);margin-top:2px">48 Vehicles ¬∑ Mumbai, Maharashtra</div>
        </div>
        <div style="display:flex;gap:10px;align-items:center">
          <div class="approval-badge">‚úÖ Lead Approved</div>
          <div style="font-size:11px;color:var(--text3);font-family:'DM Mono',monospace">Contract ID: CT-2025-0051</div>
        </div>
      </div>

      <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px">
        <div class="form-card">
          <div class="form-section-title">Contract Period</div>
          <div class="form-grid">
            <div class="form-group">
              <label>Contract Start Date *</label>
              <input type="date" id="contractStart" onchange="calcDuration()">
            </div>
            <div class="form-group">
              <label>Contract End Date *</label>
              <input type="date" id="contractEnd" onchange="calcDuration()">
            </div>
            <div class="form-group full">
              <label>Duration</label>
              <div style="padding:9px 12px;border-radius:6px;background:var(--blue-light);color:var(--blue);font-weight:700;font-size:13px" id="durationDisplay">Select dates to auto-calculate ‚Üë</div>
            </div>
          </div>

          <hr class="divider">
          <div class="form-section-title" style="margin-top:0">Maintenance Scope</div>
          <div class="form-group full">
            <label>Coverage Scope</label>
            <select>
              <option>Full Maintenance (Parts + Labor)</option>
              <option>Labor Only</option>
              <option>Preventive Maintenance Only</option>
              <option>Breakdown Support Only</option>
            </select>
          </div>

          <hr class="divider">
          <div class="form-section-title" style="margin-top:0">Pricing Model</div>
          <div class="form-grid">
            <div class="form-group">
              <label>Pricing Type</label>
              <select id="pricingType" onchange="updatePricing()">
                <option>Fixed Annual</option>
                <option>Per Vehicle</option>
                <option>Per Service</option>
              </select>
            </div>
            <div class="form-group">
              <label>Amount (‚Çπ)</label>
              <input type="number" placeholder="0.00" id="pricingAmount">
            </div>
            <div class="form-group">
              <label>Payment Terms</label>
              <select>
                <option>Monthly</option>
                <option>Quarterly</option>
                <option>Half-Yearly</option>
                <option>Annual</option>
              </select>
            </div>
            <div class="form-group">
              <label>Penalty Clause (‚Çπ/day)</label>
              <input type="number" placeholder="500">
            </div>
          </div>
        </div>

        <div>
          <div class="panel-card">
            <div class="panel-title">üìã SLA Terms</div>
            <div class="form-group" style="margin-bottom:12px">
              <label>Response Time SLA</label>
              <select>
                <option>4 Hours (Gold)</option>
                <option>8 Hours (Silver)</option>
                <option>24 Hours (Bronze)</option>
              </select>
            </div>
            <div class="form-group" style="margin-bottom:12px">
              <label>Uptime Guarantee</label>
              <select>
                <option>99.5%</option>
                <option>99%</option>
                <option>98%</option>
              </select>
            </div>
            <div class="form-group">
              <label>Service Coverage</label>
              <select>
                <option>24x7</option>
                <option>Business Hours (9‚Äì6)</option>
                <option>Extended Hours (7‚Äì10)</option>
              </select>
            </div>
          </div>

          <div class="panel-card">
            <div class="panel-title">üìä Contract Summary Preview</div>
            <div class="profit-item"><span>Fleet Size</span><span class="profit-val">48 Vehicles</span></div>
            <div class="profit-item"><span>Coverage</span><span class="profit-val">Full Maintenance</span></div>
            <div class="profit-item"><span>SLA Tier</span><span class="profit-val" style="color:var(--yellow)">Gold ‚Äì 4Hr</span></div>
            <div class="profit-item"><span>Estimated Value</span><span class="profit-val" style="color:var(--green)">‚Çπ16.8L</span></div>
            <div class="profit-item"><span>Renewal Alert</span><span class="profit-val" style="color:var(--blue)">30 days prior</span></div>
          </div>

          <div style="display:flex;flex-direction:column;gap:8px">
            <button class="topbar-btn btn-primary" onclick="generateContract()" style="width:100%;justify-content:center;padding:11px">üìÑ Generate Draft Contract</button>
            <div style="text-align:center;font-size:11px;color:var(--text3)">System will auto-generate Contract ID and PDF</div>
          </div>
        </div>
      </div>
    </div>

    <!-- ============ BILLING ============ -->
    <div class="screen" id="screen-billing">
      <div class="section-header">
        <div class="section-title">Billing Schedule</div>
        <button class="topbar-btn btn-primary">+ Generate Invoice</button>
      </div>

      <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-bottom:24px">
        <div class="card blue">
          <div class="card-label">Total Outstanding</div>
          <div class="card-value">‚Çπ8.4L</div>
          <div class="card-sub">Across 12 contracts</div>
        </div>
        <div class="card green">
          <div class="card-label">Collected This Month</div>
          <div class="card-value">‚Çπ24.2L</div>
          <div class="card-sub">‚Üë 12% vs last month</div>
        </div>
        <div class="card yellow">
          <div class="card-label">Overdue</div>
          <div class="card-value">‚Çπ1.2L</div>
          <div class="card-sub">3 invoices pending</div>
        </div>
      </div>

      <div class="table-card">
        <div class="table-header">
          <div class="table-title">Billing Schedule</div>
        </div>
        <table>
          <thead>
            <tr>
              <th>Contract ID</th>
              <th>Company</th>
              <th>Billing Freq.</th>
              <th>Last Invoice</th>
              <th>Next Invoice</th>
              <th>Amount</th>
              <th>Outstanding</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-mono" style="color:var(--blue);font-weight:600">CT-2024-0041</td>
              <td style="font-weight:600">Apex Logistics</td>
              <td>Monthly</td>
              <td>01 Feb 2025</td>
              <td style="color:var(--yellow);font-weight:600">01 Mar 2025</td>
              <td style="font-weight:700;font-family:'DM Mono',monospace">‚Çπ1,40,000</td>
              <td style="color:var(--green);font-weight:600">‚Çπ0</td>
              <td><button class="btn-sm btn-view">Invoice</button></td>
            </tr>
            <tr>
              <td class="text-mono" style="color:var(--blue);font-weight:600">CT-2024-0038</td>
              <td style="font-weight:600">Metro Movers</td>
              <td>Quarterly</td>
              <td>01 Jan 2025</td>
              <td style="color:var(--red);font-weight:600">Overdue</td>
              <td style="font-weight:700;font-family:'DM Mono',monospace">‚Çπ3,60,000</td>
              <td style="color:var(--red);font-weight:600">‚Çπ3,60,000</td>
              <td><button class="btn-sm btn-view">Invoice</button></td>
            </tr>
            <tr>
              <td class="text-mono" style="color:var(--blue);font-weight:600">CT-2024-0033</td>
              <td style="font-weight:600">SunRise Transport</td>
              <td>Monthly</td>
              <td>01 Feb 2025</td>
              <td>01 Mar 2025</td>
              <td style="font-weight:700;font-family:'DM Mono',monospace">‚Çπ76,000</td>
              <td style="color:var(--green);font-weight:600">‚Çπ0</td>
              <td><button class="btn-sm btn-view">Invoice</button></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- ============ SLA MONITORING ============ -->
    <div class="screen" id="screen-sla">
      <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-bottom:24px">
        <div class="card green">
          <div class="card-label">Healthy Contracts</div>
          <div class="card-value">128</div>
          <div class="card-sub">SLA ‚â• 95%</div>
        </div>
        <div class="card yellow">
          <div class="card-label">At Risk</div>
          <div class="card-value">10</div>
          <div class="card-sub">SLA 85‚Äì95%</div>
        </div>
        <div class="card red">
          <div class="card-label">Breach</div>
          <div class="card-value">4</div>
          <div class="card-sub">SLA &lt; 85%</div>
        </div>
      </div>

      <div class="table-card">
        <div class="table-header">
          <div class="table-title">SLA Monitoring Dashboard</div>
          <div class="flex gap-8">
            <select style="padding:6px 10px;border-radius:6px;border:1px solid var(--border);font-family:'DM Sans',sans-serif;font-size:12px;color:var(--text2);background:var(--surface2)">
              <option>All Status</option>
              <option>Healthy</option>
              <option>At Risk</option>
              <option>Breach</option>
            </select>
          </div>
        </div>
        <table>
          <thead>
            <tr>
              <th>Contract ID</th>
              <th>Company</th>
              <th>Fleet Size</th>
              <th>SLA Compliance</th>
              <th>Open Tickets</th>
              <th>Next Maintenance</th>
              <th>Next Billing</th>
              <th>Health</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-mono" style="color:var(--blue);font-weight:600">CT-2024-0041</td>
              <td style="font-weight:600">Apex Logistics</td>
              <td>48</td>
              <td>
                <div class="sla-bar-wrap">
                  <span class="sla-good">96.4%</span>
                  <div class="sla-bar-bg"><div class="sla-bar-fill" style="width:96%;background:var(--green)"></div></div>
                </div>
              </td>
              <td>2</td>
              <td>22 Feb 2025</td>
              <td>01 Mar 2025</td>
              <td><span class="badge approved">Healthy</span></td>
            </tr>
            <tr>
              <td class="text-mono" style="color:var(--blue);font-weight:600">CT-2024-0038</td>
              <td style="font-weight:600">Metro Movers</td>
              <td>67</td>
              <td>
                <div class="sla-bar-wrap">
                  <span class="sla-risk">88.2%</span>
                  <div class="sla-bar-bg"><div class="sla-bar-fill" style="width:88%;background:var(--yellow)"></div></div>
                </div>
              </td>
              <td>7</td>
              <td>18 Feb 2025</td>
              <td>01 Apr 2025</td>
              <td><span class="badge expiring">At Risk</span></td>
            </tr>
            <tr>
              <td class="text-mono" style="color:var(--blue);font-weight:600">CT-2024-0032</td>
              <td style="font-weight:600">National Fleet Services</td>
              <td>200</td>
              <td>
                <div class="sla-bar-wrap">
                  <span class="sla-breach">72.1%</span>
                  <div class="sla-bar-bg"><div class="sla-bar-fill" style="width:72%;background:var(--red)"></div></div>
                </div>
              </td>
              <td>18</td>
              <td>20 Feb 2025</td>
              <td>01 Mar 2025</td>
              <td><span class="badge rejected">Breach</span></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- ============ REPORTS ============ -->
    <div class="screen" id="screen-reports">
      <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:14px;margin-bottom:24px">
        <div class="card blue">
          <div class="card-label">Total Revenue</div>
          <div class="card-value">‚Çπ2.4Cr</div>
          <div class="card-sub">FY 2024‚Äì25</div>
        </div>
        <div class="card green">
          <div class="card-label">Contracts Active</div>
          <div class="card-value">142</div>
          <div class="card-sub">‚Üë 18% YoY</div>
        </div>
        <div class="card">
          <div class="card-label">Avg. Contract Value</div>
          <div class="card-value">‚Çπ16.9L</div>
          <div class="card-sub">Per contract</div>
        </div>
        <div class="card green">
          <div class="card-label">Renewal Rate</div>
          <div class="card-value">84%</div>
          <div class="card-sub">Target: 80%</div>
        </div>
      </div>

      <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px">
        <div class="panel-card">
          <div class="panel-title">üìà Monthly Revenue Trend</div>
          <div style="height:180px;background:var(--surface2);border-radius:6px;display:flex;align-items:flex-end;gap:6px;padding:16px;overflow:hidden">
            <div style="flex:1;background:var(--blue-light);border-radius:4px 4px 0 0;height:60%"></div>
            <div style="flex:1;background:var(--blue-light);border-radius:4px 4px 0 0;height:75%"></div>
            <div style="flex:1;background:var(--blue-light);border-radius:4px 4px 0 0;height:55%"></div>
            <div style="flex:1;background:var(--blue-light);border-radius:4px 4px 0 0;height:85%"></div>
            <div style="flex:1;background:var(--blue-light);border-radius:4px 4px 0 0;height:70%"></div>
            <div style="flex:1;background:var(--blue-light);border-radius:4px 4px 0 0;height:90%"></div>
            <div style="flex:1;background:var(--blue);border-radius:4px 4px 0 0;height:100%"></div>
          </div>
          <div style="display:flex;justify-content:space-between;font-size:10px;color:var(--text3);padding:4px 16px 0;font-family:'DM Mono',monospace">
            <span>Aug</span><span>Sep</span><span>Oct</span><span>Nov</span><span>Dec</span><span>Jan</span><span>Feb</span>
          </div>
        </div>

        <div class="panel-card">
          <div class="panel-title">üìä Contract Status Breakdown</div>
          <div style="display:flex;align-items:center;justify-content:center;gap:24px;height:180px">
            <div style="width:120px;height:120px;border-radius:50%;background:conic-gradient(var(--green) 0% 60%, var(--yellow) 60% 78%, var(--red) 78% 85%, var(--border) 85% 100%);position:relative">
              <div style="position:absolute;inset:20px;border-radius:50%;background:var(--surface);display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700">142</div>
            </div>
            <div style="display:flex;flex-direction:column;gap:8px;font-size:12px">
              <div class="flex items-center gap-8"><div style="width:10px;height:10px;border-radius:2px;background:var(--green)"></div>Active (85)</div>
              <div class="flex items-center gap-8"><div style="width:10px;height:10px;border-radius:2px;background:var(--yellow)"></div>Expiring (25)</div>
              <div class="flex items-center gap-8"><div style="width:10px;height:10px;border-radius:2px;background:var(--red)"></div>Suspended (12)</div>
              <div class="flex items-center gap-8"><div style="width:10px;height:10px;border-radius:2px;background:var(--border)"></div>Pending (20)</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ============ SETTINGS ============ -->
    <div class="screen" id="screen-settings">
      <div style="display:grid;grid-template-columns:200px 1fr;gap:20px">
        <div class="panel-card" style="padding:10px">
          <div style="display:flex;flex-direction:column;gap:2px">
            <div class="tab-btn active" style="text-align:left;padding:9px 12px">General</div>
            <div class="tab-btn" style="text-align:left;padding:9px 12px">Roles & Permissions</div>
            <div class="tab-btn" style="text-align:left;padding:9px 12px">SLA Thresholds</div>
            <div class="tab-btn" style="text-align:left;padding:9px 12px">Notifications</div>
            <div class="tab-btn" style="text-align:left;padding:9px 12px">AI Settings</div>
            <div class="tab-btn" style="text-align:left;padding:9px 12px">Integrations</div>
          </div>
        </div>
        <div>
          <div class="panel-card">
            <div class="panel-title">üîë Role-Based Access Control</div>
            <table style="width:100%">
              <thead>
                <tr>
                  <th>Feature / Permission</th>
                  <th style="text-align:center">Care Executive</th>
                  <th style="text-align:center">Customer Handler</th>
                  <th style="text-align:center">Admin</th>
                </tr>
              </thead>
              <tbody>
                <tr><td style="padding:10px 12px;font-size:13px">View Dashboard</td><td style="text-align:center">‚úÖ</td><td style="text-align:center">‚úÖ</td><td style="text-align:center">‚úÖ</td></tr>
                <tr><td style="padding:10px 12px;font-size:13px">Create Leads</td><td style="text-align:center">‚úÖ</td><td style="text-align:center">‚úÖ</td><td style="text-align:center">‚úÖ</td></tr>
                <tr><td style="padding:10px 12px;font-size:13px">Performance Review</td><td style="text-align:center">üëÅ View Only</td><td style="text-align:center">‚úÖ</td><td style="text-align:center">‚úÖ</td></tr>
                <tr><td style="padding:10px 12px;font-size:13px">Approve / Reject Leads</td><td style="text-align:center">‚ùå</td><td style="text-align:center">‚úÖ</td><td style="text-align:center">‚úÖ</td></tr>
                <tr><td style="padding:10px 12px;font-size:13px">Create Contracts</td><td style="text-align:center">‚ùå</td><td style="text-align:center">‚úÖ</td><td style="text-align:center">‚úÖ</td></tr>
                <tr><td style="padding:10px 12px;font-size:13px">Billing Management</td><td style="text-align:center">‚ùå</td><td style="text-align:center">‚úÖ</td><td style="text-align:center">‚úÖ</td></tr>
                <tr><td style="padding:10px 12px;font-size:13px">SLA Monitoring</td><td style="text-align:center">üëÅ View Only</td><td style="text-align:center">‚úÖ</td><td style="text-align:center">‚úÖ</td></tr>
                <tr><td style="padding:10px 12px;font-size:13px">Reports & Analytics</td><td style="text-align:center">‚ùå</td><td style="text-align:center">‚ùå</td><td style="text-align:center">‚úÖ</td></tr>
                <tr><td style="padding:10px 12px;font-size:13px">System Settings</td><td style="text-align:center">‚ùå</td><td style="text-align:center">‚ùå</td><td style="text-align:center">‚úÖ</td></tr>
                <tr><td style="padding:10px 12px;font-size:13px">User Management</td><td style="text-align:center">‚ùå</td><td style="text-align:center">‚ùå</td><td style="text-align:center">‚úÖ</td></tr>
                <tr><td style="padding:10px 12px;font-size:13px">AI Risk Score Override</td><td style="text-align:center">‚ùå</td><td style="text-align:center">‚ùå</td><td style="text-align:center">‚úÖ</td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- ACCESS DENIED (shared) -->
    <div class="screen" id="screen-access-denied">
      <div class="access-denied">
        <div class="access-icon">üîí</div>
        <div style="font-size:18px;font-weight:700;color:var(--text)">Access Restricted</div>
        <div class="access-text">You don't have permission to access this section.<br>Please contact your administrator for access.</div>
        <button class="topbar-btn btn-secondary" onclick="navigate('dashboard',null)" style="margin-top:8px">‚Üê Back to Dashboard</button>
      </div>
    </div>

  </div>
</main>

<!-- REJECT MODAL -->
<div class="modal-overlay" id="rejectModal">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title" style="color:var(--red)">‚ùå Reject Lead ‚Äî Reason Required</div>
      <span class="modal-close" onclick="closeModal('rejectModal')">√ó</span>
    </div>
    <div class="modal-body">
      <div style="background:var(--red-light);border-radius:6px;padding:12px;font-size:12px;color:#7f1d1d;margin-bottom:16px">
        ‚ö†Ô∏è Rejection requires a valid reason. This will be logged in the audit trail and communicated to the customer handler.
      </div>
      <div class="form-group">
        <label>Rejection Reason *</label>
        <select style="width:100%;margin-bottom:12px">
          <option>Select reason</option>
          <option>High Risk Score</option>
          <option>Poor Payment History</option>
          <option>Excessive SLA Violations</option>
          <option>Incomplete Documentation</option>
          <option>Fleet Size Outside Coverage</option>
          <option>Other</option>
        </select>
      </div>
      <div class="form-group">
        <label>Detailed Notes</label>
        <textarea placeholder="Provide detailed notes for rejection (min. 50 characters)..." style="width:100%;min-height:100px"></textarea>
      </div>
    </div>
    <div class="modal-footer">
      <button class="topbar-btn btn-secondary" onclick="closeModal('rejectModal')">Cancel</button>
      <button class="topbar-btn btn-danger" onclick="confirmReject()">Confirm Rejection</button>
    </div>
  </div>
</div>

<!-- CONTRACT GENERATED MODAL -->
<div class="modal-overlay" id="contractModal">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title" style="color:var(--green)">‚úÖ Contract Generated Successfully</div>
      <span class="modal-close" onclick="closeModal('contractModal')">√ó</span>
    </div>
    <div class="modal-body">
      <div style="background:var(--green-light);border-radius:6px;padding:14px;margin-bottom:16px;text-align:center">
        <div style="font-size:24px;font-weight:700;color:var(--green);font-family:'DM Mono',monospace">CT-2025-0051</div>
        <div style="font-size:12px;color:var(--green);margin-top:4px">Contract ID Generated</div>
      </div>
      <div class="profit-item"><span>Status</span><span class="badge pending">Pending Customer Confirmation</span></div>
      <div class="profit-item"><span>PDF</span><span style="color:var(--blue);font-size:12px;font-weight:600">üìÑ Contract_CT-2025-0051.pdf</span></div>
      <div class="profit-item"><span>Created At</span><span class="text-mono" style="font-size:12px">15 Feb 2025, 14:32</span></div>
    </div>
    <div class="modal-footer">
      <button class="topbar-btn btn-secondary" onclick="closeModal('contractModal')">Close</button>
      <button class="topbar-btn btn-primary" onclick="closeModal('contractModal');showToast('üìß Contract sent to customer!')">Send to Customer</button>
    </div>
  </div>
</div>

<!-- LEAD SUBMITTED MODAL -->
<div class="modal-overlay" id="leadModal">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title" style="color:var(--blue)">üìã Lead Generated</div>
      <span class="modal-close" onclick="closeModal('leadModal')">√ó</span>
    </div>
    <div class="modal-body">
      <div style="background:var(--blue-light);border-radius:6px;padding:14px;margin-bottom:16px;text-align:center">
        <div style="font-size:22px;font-weight:700;color:var(--blue);font-family:'DM Mono',monospace">LD-2025-0090</div>
        <div style="font-size:12px;color:var(--blue);margin-top:4px">Lead ID Auto-Generated</div>
      </div>
      <div class="profit-item"><span>Status</span><span class="badge review">Under Review</span></div>
      <div class="profit-item"><span>AI Risk Scoring</span><span style="color:var(--text3);font-size:12px">‚è≥ Processing...</span></div>
      <div class="profit-item"><span>Assigned To</span><span style="font-weight:600;font-size:13px">Auto-assigned</span></div>
      <div style="background:#f0fdf4;border-radius:6px;padding:10px;margin-top:12px;font-size:12px;color:var(--green)">
        ‚úÖ Lead submitted successfully. Handler will be notified for review.
      </div>
    </div>
    <div class="modal-footer">
      <button class="topbar-btn btn-secondary" onclick="closeModal('leadModal')">Close</button>
      <button class="topbar-btn btn-primary" onclick="closeModal('leadModal');navigate('leads',null)">View All Leads</button>
    </div>
  </div>
</div>

<!-- TOAST -->
<div class="toast" id="toast"></div>

<script>
// ROLE DEFINITIONS
const rolePermissions = {
  admin: ['dashboard','leads','leads-new','customers','review','contracts','billing','sla','reports','settings'],
  handler: ['dashboard','leads','leads-new','customers','review','contracts','billing','sla'],
  executive: ['dashboard','leads','leads-new','customers','sla']
};

const roleInfo = {
  admin: { name:'Admin User', tag:'System Administrator', avatar:'A', color:'#2563eb' },
  handler: { name:'Rahul Mehta', tag:'Customer Handler', avatar:'R', color:'#16a34a' },
  executive: { name:'Priya Kapoor', tag:'Care Executive', avatar:'P', color:'#d97706' }
};

const pageInfo = {
  dashboard: { title:'Dashboard', crumb:'Overview' },
  leads: { title:'Leads', crumb:'All Leads' },
  'leads-new': { title:'Create New Lead', crumb:'Leads ‚Üí New Lead' },
  customers: { title:'Customer Database', crumb:'All Customers' },
  review: { title:'Performance Review', crumb:'Leads ‚Üí LD-2024-0089 ‚Üí Review' },
  contracts: { title:'Contract Management', crumb:'Contracts ‚Üí Create' },
  billing: { title:'Billing Schedule', crumb:'Finance ‚Üí Billing' },
  sla: { title:'SLA Monitoring', crumb:'Operations ‚Üí SLA' },
  reports: { title:'Reports & Analytics', crumb:'Analytics ‚Üí Reports' },
  settings: { title:'System Settings', crumb:'Settings ‚Üí Access Control' }
};

let currentRole = 'admin';

function changeRole(role) {
  currentRole = role;
  const info = roleInfo[role];
  document.getElementById('userAvatar').textContent = info.avatar;
  document.getElementById('userAvatar').style.background = info.color;
  document.getElementById('userName').textContent = info.name;
  document.getElementById('userRoleTag').textContent = info.tag;

  // Update nav items - lock restricted ones
  document.querySelectorAll('.nav-item').forEach(item => {
    const screen = item.getAttribute('data-screen');
    const roles = item.getAttribute('data-roles');
    if (!roles) return;
    const allowedRoles = roles.split(',');
    if (allowedRoles.includes(role)) {
      item.classList.remove('locked');
      item.title = '';
    } else {
      item.classList.add('locked');
      item.title = 'Access restricted for your role';
    }
  });

  // Update topbar action button
  const actionBtn = document.getElementById('topbarAction');
  if (role === 'executive') {
    actionBtn.textContent = '+ New Lead';
  } else {
    actionBtn.textContent = '+ New Lead';
  }

  showToast('üîë Switched to ' + info.tag + ' view');
}

function navigate(screenName, navElement) {
  // Check permission
  const allowed = rolePermissions[currentRole];
  const targetScreen = screenName;

  if (!allowed.includes(targetScreen)) {
    // Show access denied
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById('screen-access-denied').classList.add('active');
    document.getElementById('pageTitle').textContent = 'Access Denied';
    document.getElementById('breadcrumb').textContent = screenName;
    // Remove active from nav
    document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
    return;
  }

  // Hide all screens
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  const target = document.getElementById('screen-' + screenName);
  if (target) target.classList.add('active');

  // Update nav active state
  if (navElement) {
    document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
    navElement.classList.add('active');
  } else {
    // Try to find matching nav item
    document.querySelectorAll('.nav-item').forEach(i => {
      i.classList.remove('active');
      if (i.getAttribute('data-screen') === screenName) i.classList.add('active');
    });
  }

  // Update page title
  const info = pageInfo[screenName];
  if (info) {
    document.getElementById('pageTitle').textContent = info.title;
    document.getElementById('breadcrumb').textContent = info.crumb;
  }

  // Update topbar action
  const actionBtn = document.getElementById('topbarAction');
  if (screenName === 'dashboard' || screenName === 'leads') {
    actionBtn.style.display = 'flex';
    actionBtn.textContent = '+ New Lead';
  } else if (screenName === 'contracts') {
    actionBtn.style.display = 'flex';
    actionBtn.textContent = '+ New Contract';
  } else {
    actionBtn.style.display = 'none';
  }
}

function showRejectModal() {
  document.getElementById('rejectModal').classList.add('show');
}

function closeModal(id) {
  document.getElementById(id).classList.remove('show');
}

function confirmReject() {
  closeModal('rejectModal');
  const actions = document.getElementById('decisionActions');
  const result = document.getElementById('decisionResult');
  actions.style.display = 'none';
  result.style.display = 'block';
  result.style.background = '#fee2e2';
  result.style.color = '#7f1d1d';
  result.innerHTML = '‚ùå <strong>Lead Rejected</strong><br><span style="font-size:11px">Status updated. Audit log recorded.</span>';
  showToast('‚ùå Lead rejected successfully. Audit log updated.');
}

function approveLeadAction() {
  const actions = document.getElementById('decisionActions');
  const result = document.getElementById('decisionResult');
  actions.style.display = 'none';
  result.style.display = 'block';
  result.style.background = '#dcfce7';
  result.style.color = '#14532d';
  result.innerHTML = '‚úÖ <strong>Lead Approved</strong><br><span style="font-size:11px">Contract creation is now enabled. Audit log recorded.</span>';
  showToast('‚úÖ Lead approved! Contract creation now available.');
}

function submitLead() {
  document.getElementById('leadModal').classList.add('show');
}

function generateContract() {
  document.getElementById('contractModal').classList.add('show');
}

function calcDuration() {
  const start = document.getElementById('contractStart').value;
  const end = document.getElementById('contractEnd').value;
  const disp = document.getElementById('durationDisplay');
  if (start && end) {
    const s = new Date(start), e = new Date(end);
    const diff = Math.round((e - s) / (1000 * 60 * 60 * 24));
    if (diff > 0) {
      const months = Math.round(diff / 30);
      const years = Math.floor(months / 12);
      const rem = months % 12;
      let label = '';
      if (years > 0) label += years + ' Year' + (years > 1 ? 's' : '');
      if (rem > 0) label += (years > 0 ? ' ' : '') + rem + ' Month' + (rem > 1 ? 's' : '');
      disp.textContent = 'üìÖ ' + label + ' (' + diff + ' days) ‚Äî Auto Calculated';
    } else {
      disp.textContent = '‚ö†Ô∏è End date must be after start date';
      disp.style.color = 'var(--red)';
      disp.style.background = 'var(--red-light)';
      return;
    }
    disp.style.color = 'var(--blue)';
    disp.style.background = 'var(--blue-light)';
  }
}

function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 3500);
}

// Make topbar action show new lead screen
document.getElementById('topbarAction').addEventListener('click', function() {
  navigate('leads-new', null);
});

// Tab buttons
document.querySelectorAll('.tab-btn').forEach(btn => {
  btn.addEventListener('click', function() {
    this.closest('.tabs').querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
    this.classList.add('active');
  });
});

// Init
changeRole('admin');
</script>
</body>
</html>